# Транспортная задача
Тушавин В. А.  
20 ноября 2015 г.  

### Задача 1
#### Постановка задачи

Транспортное задачей называется разновидность задачи линейного программирования, общая постановка которой такова.

Имеется  _m_  пунктов производства однородного продукта с объемами производства *a~1~, a~2~,...,a~m~* и  n пунктов потребления с объемами потребления *b~1~, b~2~,...,b~m~*. Известна стоимость перевозки единицы продукта от каждого пункта производства до каждого пункта потребления: *c~ij~*, *i*=*1...m*, *j*=*1...n*.

Решим задачу:

 a:b |  210 |  50 |  90 |  150
-----|------|-----|-----|------     
  60 |   5  |  15 |  10 |   9
 110 |   8  |  10 |   9 |   7
 170 |   7  |   6 |   6 |   9
 160 |  11  |   5 |   7 |  12

### Решение в R

Для решения этой задачи линеного программирования в GNU R можно использовать пакет lpSolve.

Выгрузим из Excel файла, содержащего эту таблицу, данные в формате csv. 

Результат будет выглядеть следующим образом:

```
0;210;50;90;150
60;5;15;10;9
110;8;10;9;7
170;7;6;6;9
160;11;5;7;12
```

Загрузим эти данные в переменную (таблицу) mydata, указав разделитель колонок (;) и то, что первая строка не является заголовком. Посмотрим результат.


```r
mydata<-read.csv("lp02.csv",sep=";",header=F)
mydata
```

```
##    V1  V2 V3 V4  V5
## 1   0 210 50 90 150
## 2  60   5 15 10   9
## 3 110   8 10  9   7
## 4 170   7  6  6   9
## 5 160  11  5  7  12
```

Выделим из таблицы векторы *a*, *b*, а также матрицу *C*. Для того, чтобы получить *a* достаточно взять в первой строке значения со 2 по 5, для *b* --- значения со 2 по 5 в 1 колонке. Матрица *C* находится аналогично (см. код).


```r
a<-mydata[1,2:5]
a
```

```
##    V2 V3 V4  V5
## 1 210 50 90 150
```

```r
b<-mydata[2:5,1]
b
```

```
## [1]  60 110 170 160
```

```r
C<-mydata[2:5,2:5]
C
```

```
##   V2 V3 V4 V5
## 2  5 15 10  9
## 3  8 10  9  7
## 4  7  6  6  9
## 5 11  5  7 12
```
Присвоим имена для строк и столбцов. Это необязательный элемент.


```r
names(a)<-paste0("a",1:4)
names(b)<-paste0("b",1:4)
names(C)<-paste0("a",1:4)
rownames(C)<-paste0("b",1:4)
a
```

```
##    a1 a2 a3  a4
## 1 210 50 90 150
```

```r
b
```

```
##  b1  b2  b3  b4 
##  60 110 170 160
```

```r
C
```

```
##    a1 a2 a3 a4
## b1  5 15 10  9
## b2  8 10  9  7
## b3  7  6  6  9
## b4 11  5  7 12
```

Проверка условий

```r
sum(a)
```

```
## [1] 500
```

```r
sum(b)
```

```
## [1] 500
```

В данном случае задача закрытого типа.

В пакете lpsolve есть функция 

lp.transport (cost.mat, direction="min", row.signs, row.rhs, col.signs,col.rhs, presolve=0, compute.sens=0, integers = 1:(nc*nr) )

cost.mat - матрица стоимостей, в нашем случае C

direction="min" - решаем задачу на минимизацию

row.signs - знак, в нашем случае "==" равенство

row.rhs - в нашем случае *b*

col.signs - знак, в нашем случае "==" равенство

col.rhs - в нашем случае *a*

Решим задачу


```r
library(lpSolve) # Подключили библиотеку
row.signs <- rep ("==", 4)
col.signs <- rep ("==", 4)
(result<-lp.transport(as.matrix(C), "min", row.signs, b, col.signs, a))
```

```
## Success: the objective function is 3420
```

```r
result$solution
```

```
##      [,1] [,2] [,3] [,4]
## [1,]   60    0    0    0
## [2,]    0    0    0  110
## [3,]  150    0    0   20
## [4,]    0   50   90   20
```

Таким образом, найдено минимальное решение равное 3420 и построена матрица решения.

### Задача 2


 a:b |   10 |   20 |   40 |   75
-----|------|------|------|------   
  80 |    7 |   12 |   18 |   19
  12 |    7 |   13 |   11 |   11
  38 |   19 |   18 |   12 |   13
  45 |   11 |    3 |   11 |    4


Решение аналогично предыдущей


```r
mydata<-read.csv("lp02-2.csv",sep=";",header=F)
a<-mydata[1,2:5]
a
```

```
##   V2 V3 V4 V5
## 1 10 20 40 75
```

```r
b<-mydata[2:5,1]
b
```

```
## [1] 80 12 38 45
```

```r
C<-mydata[2:5,2:5]
C
```

```
##   V2 V3 V4 V5
## 2  7 12 18 19
## 3  7 13 11 11
## 4 19 18 12 13
## 5 11  3 11  4
```

```r
sum(a)
```

```
## [1] 145
```

```r
sum(b)
```

```
## [1] 175
```
Как мы видим, суммы строк и столбцов не совпали, следовательно это задача открытого типа. Можно решить её добавив еще колонку с нулевыми весами и потребностями 30, а можно воспользоваться неравенствами


```r
row.signs <- rep ("<=", 4)
col.signs <- rep ("==", 4)
(result<-lp.transport(as.matrix(C), "min", row.signs, b, col.signs, a))
```

```
## Success: the objective function is 1456
```

```r
result$solution
```

```
##      [,1] [,2] [,3] [,4]
## [1,]   10   20   20    0
## [2,]    0    0    0   12
## [3,]    0    0   20   18
## [4,]    0    0    0   45
```

Решение найдено. Следует отметить, что в данном случае задача имеет альтернативный оптимум, который не был найден программой.

#### Информация о параметрах R


```r
sessionInfo()
```

```
## R version 3.2.0 (2015-04-16)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 7 x64 (build 7601) Service Pack 1
## 
## locale:
## [1] LC_COLLATE=Russian_Russia.1251  LC_CTYPE=Russian_Russia.1251   
## [3] LC_MONETARY=Russian_Russia.1251 LC_NUMERIC=C                   
## [5] LC_TIME=Russian_Russia.1251    
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] lpSolve_5.6.11
## 
## loaded via a namespace (and not attached):
##  [1] magrittr_1.5    tools_3.2.0     htmltools_0.2.6 yaml_2.1.13    
##  [5] stringi_0.4-1   rmarkdown_0.6.1 knitr_1.10.5    stringr_1.0.0  
##  [9] digest_0.6.8    evaluate_0.8
```
