---
title: "Транспортная задача"
author: "Тушавин В. А."
date: "20 ноября 2015 г."
output: 
  html_document: 
    keep_md: yes
---

### Задача 1
#### Постановка задачи

Транспортное задачей называется разновидность задачи линейного программирования, общая постановка которой такова.

Имеется  _m_  пунктов производства однородного продукта с объемами производства *a~1~, a~2~,...,a~m~* и  n пунктов потребления с объемами потребления *b~1~, b~2~,...,b~m~*. Известна стоимость перевозки единицы продукта от каждого пункта производства до каждого пункта потребления: *c~ij~*, *i*=*1...m*, *j*=*1...n*.

Решим задачу:

 a:b |  210 |  50 |  90 |  150
-----|------|-----|-----|------     
  60 |   5  |  15 |  10 |   9
 110 |   8  |  10 |   9 |   7
 170 |   7  |   6 |   6 |   9
 160 |  11  |   5 |   7 |  12

### Решение в R

Для решения этой задачи линеного программирования в GNU R можно использовать пакет lpSolve.

Выгрузим из Excel файла, содержащего эту таблицу, данные в формате csv. 

Результат будет выглядеть следующим образом:

```
0;210;50;90;150
60;5;15;10;9
110;8;10;9;7
170;7;6;6;9
160;11;5;7;12
```

Загрузим эти данные в переменную (таблицу) mydata, указав разделитель колонок (;) и то, что первая строка не является заголовком. Посмотрим результат.

```{r}
mydata<-read.csv("lp02.csv",sep=";",header=F)
mydata
```

Выделим из таблицы векторы *a*, *b*, а также матрицу *C*. Для того, чтобы получить *a* достаточно взять в первой строке значения со 2 по 5, для *b* --- значения со 2 по 5 в 1 колонке. Матрица *C* находится аналогично (см. код).

```{r}
a<-mydata[1,2:5]
a
b<-mydata[2:5,1]
b
C<-mydata[2:5,2:5]
C
```
Присвоим имена для строк и столбцов. Это необязательный элемент.

```{r}
names(a)<-paste0("a",1:4)
names(b)<-paste0("b",1:4)
names(C)<-paste0("a",1:4)
rownames(C)<-paste0("b",1:4)
a
b
C
```

Проверка условий
```{r}
sum(a)
sum(b)

```

В данном случае задача закрытого типа.

В пакете lpsolve есть функция 

lp.transport (cost.mat, direction="min", row.signs, row.rhs, col.signs,col.rhs, presolve=0, compute.sens=0, integers = 1:(nc*nr) )

cost.mat - матрица стоимостей, в нашем случае C

direction="min" - решаем задачу на минимизацию

row.signs - знак, в нашем случае "==" равенство

row.rhs - в нашем случае *b*

col.signs - знак, в нашем случае "==" равенство

col.rhs - в нашем случае *a*

Решим задачу

```{r}
library(lpSolve) # Подключили библиотеку
row.signs <- rep ("==", 4)
col.signs <- rep ("==", 4)
(result<-lp.transport(as.matrix(C), "min", row.signs, b, col.signs, a))
result$solution
```

Таким образом, найдено минимальное решение равное 3420 и построена матрица решения.

### Задача 2


 a:b |   10 |   20 |   40 |   75
-----|------|------|------|------   
  80 |    7 |   12 |   18 |   19
  12 |    7 |   13 |   11 |   11
  38 |   19 |   18 |   12 |   13
  45 |   11 |    3 |   11 |    4


Решение аналогично предыдущей

```{r}
mydata<-read.csv("lp02-2.csv",sep=";",header=F)
a<-mydata[1,2:5]
a
b<-mydata[2:5,1]
b
C<-mydata[2:5,2:5]
C
sum(a)
sum(b)
```
Как мы видим, суммы строк и столбцов не совпали, следовательно это задача открытого типа. Можно решить её добавив еще колонку с нулевыми весами и потребностями 30, а можно воспользоваться неравенствами

```{r}
row.signs <- rep ("<=", 4)
col.signs <- rep ("==", 4)
(result<-lp.transport(as.matrix(C), "min", row.signs, b, col.signs, a))
result$solution
```

Решение найдено. Следует отметить, что в данном случае задача имеет альтернативный оптимум, который не был найден программой.

#### Информация о параметрах R

```{r}
sessionInfo()

```
